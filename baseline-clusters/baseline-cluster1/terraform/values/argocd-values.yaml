# ArgoCD values for baseline-cluster1
global:
  domain: argocd.example.com

server:
  service:
    type: LoadBalancer
  
  extraArgs:
    - --insecure  # Use ingress for TLS termination
  
  config:
    url: https://argocd.example.com
    application.instanceLabelKey: argocd.argoproj.io/instance
  
  rbacConfig:
    policy.default: role:readonly
    policy.csv: |
      p, role:org-admin, applications, *, */*, allow
      p, role:org-admin, clusters, get, *, allow
      p, role:org-admin, repositories, get, *, allow
      p, role:org-admin, repositories, create, *, allow
      p, role:org-admin, repositories, update, *, allow
      p, role:org-admin, repositories, delete, *, allow
      g, platform-team, role:org-admin

controller:
  metrics:
    enabled: true
    serviceMonitor:
      enabled: true

repoServer:
  metrics:
    enabled: true
    serviceMonitor:
      enabled: true

applicationSet:
  enabled: true

notifications:
  enabled: true

dex:
  enabled: false  # Use Azure AD instead

configs:
  cm:
    admin.enabled: "true"
    timeout.reconciliation: 180s
    resource.customizations.health.argoproj.io_Application: |
      hs = {}
      hs.status = "Progressing"
      hs.message = ""
      if obj.status ~= nil then
        if obj.status.health ~= nil then
          hs.status = obj.status.health.status
          if obj.status.health.message ~= nil then
            hs.message = obj.status.health.message
          end
        end
      end
      return hs
